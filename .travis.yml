language: cpp
compiler:
  - gcc

before_install:
  # Add a PPA for Boost 1.55.
  - sudo add-apt-repository ppa:boost-latest/ppa -y
  - sudo apt-get update -qq

install:
  # Currently inside the cloned repo path.
  # Install libespm.
  - git clone https://github.com/WrinklyNinja/libespm.git ../libespm
  # Install Boost.
  - sudo apt-get install -y libboost-filesystem1.55-dev libboost-locale1.55-dev libboost-iostreams1.55-dev libboost-regex1.55-dev
  # Install Google Test
  - cd ..
  - wget https://googletest.googlecode.com/files/gtest-1.7.0.zip
  - unzip gtest-1.7.0.zip
  - cd gtest-1.7.0
  - cmake .
  - make
  # Move back into the cloned libloadorder repo path.
  - cd $TRAVIS_BUILD_DIR

before_script:
  - mkdir build
  - cd build
  # Fetch plugins to test with.
  - wget https://github.com/WrinklyNinja/testing-plugins/archive/master.zip
  - unzip master.zip
  - mv testing-plugins-master/* ./
  # Travis machines are 64 bit, and the deps use dynamic linking.
  - cmake .. -DPROJECT_ARCH=64 -DPROJECT_STATIC_RUNTIME=OFF -DGTEST_ROOT=../gtest-1.7.0

script: make && ./libloadorder-tester
